Code for https://docs.google.com/document/d/185lUQmxxwAXwJteWdK0JOiY89aaSU5lBxGZT1l1qycU/edit?usp=sharing
